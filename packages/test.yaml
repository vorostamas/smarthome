#- platform: verizonwireless
#  username: !secret vzw_username
#  password: !secret vzw_password
#  secret: !secret vzw_secret


# homeassistant:
#   customize:

#     script.set_random_color_2_all_bulbs:
#       hidden: false
#     script.light_set_color:
#       hidden: true

# input_label:
#   hue_color_lamp_1_random_color:
#     value: "no"
#   hue_color_lamp_2_random_color:
#     value: "no"
#   hue_color_lamp_3_random_color:
#     value: "no"

# group:
#   Family Room Hue Bulbs:
#     entities:
#       - light.hue_color_lamp_1
#       - light.hue_color_lamp_2
#       - light.hue_color_lamp_3
#   Input Labels:
#     entities:
#       - input_label.hue_color_lamp_1_random_color
#       - input_label.hue_color_lamp_2_random_color
#       - input_label.hue_color_lamp_3_random_color

# script:
#   set_random_color_2_all_bulbs:
#     sequence:
#       - condition: template
#         value_template: >
#             {%- macro get_next_entity_id() -%}
#               {%- for item in states.group.input_labels.attributes.entity_id if is_state(item, "no") -%}
#                 {{- "," if not loop.first-}}{{- item -}}{{-endif-}}
#               {%- endfor -%}              
#             {%- endmacro -%}
#             {%- set entity_ids = get_next_entity_id() -%}
#             {% if entity_ids | trim != "" and entity_ids.split(',') | length | int == 0 %}
#               false
#             {% else %}
#               true
#             {% endif %}
#       - delay: '00:00:01'
#       - service: script.light_set_color
#         data_template:
#           entity_id: >-
#             {%- macro get_next_entity_id() -%}
#               {%- for item in states.group.input_labels.attributes.entity_id if is_state(item, "no") -%}
#                 {{- "," if not loop.first-}}{{- item -}}{{-endif-}}
#               {%- endfor -%}              
#             {%- endmacro -%}
#             {%- set entity_ids = get_next_entity_id() -%}
#             {% if entity_ids | trim != "" %}
#               {%- if entity_ids.split(',') | length > 0 -%}
#                 {{- 'light.' ~ entity_ids.split(',')[0].split('.')[1].replace('_random_color', '') -}}
#               {%- endif -%}
#             {% endif %}
#           brightness: 254
#           r: '{{ "{0:d}".format(range(210, 238)|random) }}'
#           g: '{{ "{0:d}".format(range(100, 132)|random) }}'
#           b: '{{ "{0:d}".format(range(240, 254)|random) }}'

#   light_set_color:
#     sequence:
#       - condition: template
#         value_template: '{{ entity_id | trim != "" }}'
#       - condition: template
#         value_template: '{{ brightness | trim != "" }}'
#       - service: light.turn_on
#         data_template:
#           entity_id: '{{ entity_id }}'
#           brightness: '{{ brightness }}'
#           rgb_color: ['{{"{0:d}".format(range(210, 238)|random)|int}}', '{{"{0:d}".format(range(210, 238)|random)|int}}', '{{"{0:d}".format(range(210, 238)|random)|int}}']
#       - service: input_label.set_value
#         data_template:
#           entity_id: "input_label.{{- entity_id.split('.')[1] -}}_random_color"
#           value: 'yes'
#       - delay: '00:00:01'
#       - service: script.set_random_color_2_all_bulbs

# automation:
#   - alias: Fire Event
#     trigger:
#       platform: state
#       entity_id: switch.kitchen
#     action:
#       event: my_test_event
#       event_data:
#         foo: "bar"

#   - alias: Capture Event
#     trigger:
#       platform: event
#       event_type: my_test_event
#     action:
#       - service: script.notify_me
#         data_template:
#           message: "Test Event Captured with data foo: {{ trigger.event.data.foo }}"